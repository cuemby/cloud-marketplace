# Cuemby defaults for Elasticsearch on single-node K3s.
# These override the upstream bitnami/elasticsearch defaults for our environment.

elasticsearch:
  # Single-node mode: master handles all roles
  master:
    replicaCount: 1
    heapSize: 1024m
    resources:
      requests:
        cpu: 500m
        memory: 1Gi
      limits:
        cpu: "2"
        memory: 2Gi
    persistence:
      enabled: true
      storageClass: local-path
      size: 20Gi
    # Generous JVM probes (Elasticsearch needs time to initialize)
    startupProbe:
      enabled: true
      initialDelaySeconds: 90
      periodSeconds: 10
      timeoutSeconds: 10
      failureThreshold: 30
      successThreshold: 1
    livenessProbe:
      initialDelaySeconds: 120
      periodSeconds: 20
      timeoutSeconds: 10
      failureThreshold: 6
    readinessProbe:
      initialDelaySeconds: 60
      periodSeconds: 10
      timeoutSeconds: 10
      failureThreshold: 6

  # Disable separate data/coordinating/ingest nodes (single-node mode)
  data:
    replicaCount: 0
  coordinating:
    replicaCount: 0
  ingest:
    replicaCount: 0

  # Expose REST API via NodePort
  service:
    type: NodePort
    nodePorts:
      restAPI: 30920

  # Security
  security:
    enabled: true
    tls:
      restEncryption: false

  # Disable metrics by default
  metrics:
    enabled: false
